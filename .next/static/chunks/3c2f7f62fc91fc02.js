(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39144,e=>{"use strict";var s=e.i(17927);function t(e){return{id:e.id,routineId:e.routine_id,routineName:e.routine_name??"",startedAt:e.started_at?new Date(e.started_at):new Date,finishedAt:e.finished_at?new Date(e.finished_at):new Date,exercises:(e.session_exercises??[]).map(e=>({id:e.id,exerciseId:e.exercise_id,exerciseName:e.exercise_name??"Exercício",category:e.category??"weight-reps",position:e.position??0,sets:(e.sets??[]).map(e=>({id:e.id,setIndex:e.set_index,reps:e.reps??null,weightKg:e.weight_kg??null,durationSec:e.duration_sec??null,distanceM:e.distance_m??null}))}))}}e.s(["sessionsApi",0,{async getAll(){let{data:e,error:i}=await s.supabase.from("sessions").select(`
        id,
        routine_id,
        started_at,
        finished_at,
        session_exercises (
          id,
          exercise_id,
          sets (
            id,
            set_index,
            reps,
            weight_kg,
            duration_sec,
            distance_m
          )
        )
      `).order("started_at",{ascending:!1});if(i)throw i;return e.map(t)},async getById(e){let{data:i,error:r}=await s.supabase.from("sessions").select(`
        id,
        routine_id,
        started_at,
        finished_at,
        session_exercises (
          id,
          exercise_id,
          sets (
            id,
            set_index,
            reps,
            weight_kg,
            duration_sec,
            distance_m
          )
        )
      `).eq("id",e).single();if(r)throw r;return t(i)},async create(e){let{data:t}=await s.supabase.auth.getUser(),i=t?.user?.id;if(!i)throw Error("Usuário não autenticado");let{data:r,error:n}=await s.supabase.from("sessions").insert({user_id:i,routine_id:e.routineId,started_at:e.startedAt,finished_at:e.finishedAt}).select("*").single();if(n)throw n;for(let t of e.exercises){let{data:e,error:i}=await s.supabase.from("session_exercises").insert({session_id:r.id,exercise_id:t.exerciseId}).select("*").single();if(i)throw i;if(t.sets.length>0){let i=t.sets.map((s,t)=>({session_exercise_id:e.id,set_index:t,reps:s.reps??null,weight_kg:s.weightKg??null,duration_sec:s.durationSec??null,distance_m:s.distanceM??null})),{error:r}=await s.supabase.from("sets").insert(i);if(r)throw r}}return this.getById(r.id)}}],39144)},91918,e=>{"use strict";var s=e.i(71645);function t(e,s){if("function"==typeof e)return e(s);null!=e&&(e.current=s)}var i=e.i(43476),r=s.forwardRef((e,t)=>{let{children:r,...a}=e,o=s.Children.toArray(r),l=o.find(d);if(l){let e=l.props.children,r=o.map(t=>t!==l?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,i.jsx)(n,{...a,ref:t,children:s.isValidElement(e)?s.cloneElement(e,void 0,r):null})}return(0,i.jsx)(n,{...a,ref:t,children:r})});r.displayName="Slot";var n=s.forwardRef((e,i)=>{let{children:r,...n}=e;if(s.isValidElement(r)){var a;let e,d,o=(a=r,(d=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(d=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref);return s.cloneElement(r,{...function(e,s){let t={...s};for(let i in s){let r=e[i],n=s[i];/^on[A-Z]/.test(i)?r&&n?t[i]=(...e)=>{n(...e),r(...e)}:r&&(t[i]=r):"style"===i?t[i]={...r,...n}:"className"===i&&(t[i]=[r,n].filter(Boolean).join(" "))}return{...e,...t}}(n,r.props),ref:i?function(...e){return s=>{let i=!1,r=e.map(e=>{let r=t(e,s);return i||"function"!=typeof r||(i=!0),r});if(i)return()=>{for(let s=0;s<r.length;s++){let i=r[s];"function"==typeof i?i():t(e[s],null)}}}}(i,o):o})}return s.Children.count(r)>1?s.Children.only(null):null});n.displayName="SlotClone";var a=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});function d(e){return s.isValidElement(e)&&e.type===a}e.s(["Slot",()=>r],91918)},67881,31278,e=>{"use strict";let s,t;var i=e.i(43476),r=e.i(91918),n=e.i(7670);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,d=n.clsx;var o=e.i(47163);let l=(s="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}},e=>{var i;if((null==t?void 0:t.variants)==null)return d(s,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:r,defaultVariants:n}=t,o=Object.keys(r).map(s=>{let t=null==e?void 0:e[s],i=null==n?void 0:n[s];if(null===t)return null;let d=a(t)||a(i);return r[s][d]}),l=e&&Object.entries(e).reduce((e,s)=>{let[t,i]=s;return void 0===i||(e[t]=i),e},{});return d(s,o,null==t||null==(i=t.compoundVariants)?void 0:i.reduce((e,s)=>{let{class:t,className:i,...r}=s;return Object.entries(r).every(e=>{let[s,t]=e;return Array.isArray(t)?t.includes({...n,...l}[s]):({...n,...l})[s]===t})?[...e,t,i]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)});function u({className:e,variant:s,size:t,asChild:n=!1,...a}){let d=n?r.Slot:"button";return(0,i.jsx)(d,{"data-slot":"button",className:(0,o.cn)(l({variant:s,size:t,className:e})),...a})}e.s(["Button",()=>u],67881);let c=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>c],31278)},25511,e=>{"use strict";var s=e.i(17927);function t(e){return{id:e.id,name:e.name,category:e.category,createdAt:new Date(e.created_at),userId:e.user_id,suggestedReps:e.suggested_reps,suggestedWeight:e.suggested_weight,suggestedTime:e.suggested_time,suggestedDistance:e.suggested_distance}}e.s(["exercisesApi",0,{async getAll(){let{data:e,error:i}=await s.supabase.from("exercises").select("*").order("name",{ascending:!0});if(i)throw i;return e.map(t)},async getById(e){let{data:i,error:r}=await s.supabase.from("exercises").select("*").eq("id",e).single();if(r)throw r;return t(i)},async create(e,i){var r;let n={name:(r={...e,userId:i}).name,category:r.category,user_id:r.userId,suggested_reps:r.suggestedReps??null,suggested_weight:r.suggestedWeight??null,suggested_time:r.suggestedTime??null,suggested_distance:r.suggestedDistance??null},{data:a,error:d}=await s.supabase.from("exercises").insert(n).select().single();if(d)throw d;return t(a)},async delete(e){let{error:t}=await s.supabase.from("exercises").delete().eq("id",e);if(t)throw t;return!0}}],25511)},7264,e=>{"use strict";var s=e.i(17927);function t(e){return{id:e.id,name:e.name,createdAt:e.created_at,userId:e.user_id,exercises:(e.routine_exercises??[]).map(e=>({id:e.id,exerciseId:e.exercise_id,position:e.position,suggestedSets:e.suggested_sets??null,suggestedReps:e.suggested_reps??null,advancedTechnique:e.advanced_technique??""}))}}let i={async getAll(){let{data:e,error:i}=await s.supabase.from("routines").select(`
        id,
        name,
        created_at,
        user_id,
        routine_exercises (
          id,
          exercise_id,
          position,
          suggested_sets,
          suggested_reps,
          advanced_technique
        )
      `).order("created_at",{ascending:!1});if(i)throw i;return e.map(t)},async getById(e){let{data:i,error:r}=await s.supabase.from("routines").select(`
        id,
        name,
        created_at,
        user_id,
        routine_exercises (
          id,
          exercise_id,
          position,
          suggested_sets,
          suggested_reps,
          advanced_technique
        )
      `).eq("id",e).single();if(r)throw r;return t(i)},async create(e){let{data:t,error:r}=await s.supabase.from("routines").insert({name:e.name,user_id:e.userId}).select("*").single();if(r)throw r;if(e.exercises.length>0){let i=e.exercises.map(e=>({routine_id:t.id,exercise_id:e.exerciseId,position:e.position,suggested_sets:e.suggestedSets??null,suggested_reps:e.suggestedReps??null,advanced_technique:e.advancedTechnique??""})),{error:r}=await s.supabase.from("routine_exercises").insert(i);if(r)throw r}return i.getById(t.id)},async update(e,t){let{data:r}=await s.supabase.auth.getUser(),n=r?.user?.id;if(!n)throw Error("Usuário não autenticado");let a={name:t.name,user_id:n,exercises:t.exercises.map(e=>({exercise_id:e.exerciseId,position:e.position,suggested_sets:e.suggestedSets??null,suggested_reps:e.suggestedReps??null,advanced_technique:e.advancedTechnique??""}))},{error:d}=await s.supabase.from("routines").update({name:a.name,user_id:n}).eq("id",e);if(d)throw d;await s.supabase.from("routine_exercises").delete().eq("routine_id",e);let o=a.exercises.map(s=>({routine_id:e,exercise_id:s.exercise_id??s.exerciseId,position:s.position,suggested_sets:s.suggested_sets??s.suggestedSets??null,suggested_reps:s.suggested_reps??s.suggestedReps??null,advanced_technique:s.advanced_technique??s.advancedTechnique??""})),{error:l}=await s.supabase.from("routine_exercises").insert(o);if(l)throw l;return await i.getById(e)},async delete(e){let{error:t}=await s.supabase.from("routines").delete().eq("id",e);if(t)throw t;return!0}};e.s(["routinesApi",0,i],7264)},13097,e=>{"use strict";var s=e.i(43476),t=e.i(71645),i=e.i(18566),r=e.i(7264),n=e.i(39144),a=e.i(25511),d=e.i(67881),o=e.i(31278);function l(){let e=(0,i.useSearchParams)(),l=(0,i.useRouter)(),u=e.get("routine"),[c,g]=(0,t.useState)(!0),[p,m]=(0,t.useState)(!1),[f,h]=(0,t.useState)(null),[x]=(0,t.useState)(()=>new Date),[_,v]=(0,t.useState)([]);async function w(){if(!f)return void alert("Rotina não carregada.");m(!0);try{await n.sessionsApi.create({routineId:u,startedAt:x,finishedAt:new Date,exercises:_.map(e=>({exerciseId:e.exerciseId,category:e.category,sets:e.sets.map(e=>({id:e.id??crypto.randomUUID(),reps:e.reps??null,weightKg:e.weightKg??null,durationSec:e.durationSec??null,distanceM:e.distanceM??null}))}))}),l.push("/historico")}catch(e){console.error(e),alert("Erro ao salvar sessão.")}finally{m(!1)}}return(0,t.useEffect)(()=>{!async function(){if(!u)return l.push("/rotinas");g(!0);try{let[e,s]=await Promise.all([r.routinesApi.getById(u),a.exercisesApi.getAll()]);h(e);let t=e.exercises.map((e,t)=>{let i=s.find(s=>s.id===e.exerciseId);return{exerciseId:e.exerciseId,name:i?.name??"Exercício",category:i?.category??"peso_reps",position:e.position??t,sets:[]}});v(t)}finally{g(!1)}}()},[u,l]),c?(0,s.jsx)("div",{className:"flex justify-center items-center min-h-[70vh]",children:(0,s.jsx)(o.Loader2,{className:"w-8 h-8 animate-spin"})}):f?(0,s.jsxs)("div",{className:"p-6 max-w-3xl mx-auto flex flex-col gap-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:f.name}),_.map((e,t)=>(0,s.jsxs)("div",{className:"rounded-lg border p-4 bg-card",children:[(0,s.jsx)("h2",{className:"font-semibold",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mb-1",children:["Categoria: ",e.category]}),(0,s.jsx)(d.Button,{onClick:()=>{v(e=>{let s=[...e];return s[t].sets.push({id:crypto.randomUUID(),reps:10,weightKg:null,durationSec:null,distanceM:null}),s})},className:"mt-3",variant:"outline",children:"+ Registrar set"}),(0,s.jsxs)("div",{className:"mt-3 flex flex-col gap-2",children:[e.sets.map((e,t)=>(0,s.jsxs)("div",{className:"border rounded-md p-2 flex justify-between text-sm",children:[(0,s.jsxs)("span",{children:["Set ",t+1]}),(0,s.jsxs)("span",{children:[e.reps," reps"]})]},e.id)),0===e.sets.length&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Nenhum set registrado ainda."})]})]},e.exerciseId)),(0,s.jsx)(d.Button,{className:"bg-green-600 hover:bg-green-700 mt-6",onClick:w,disabled:p,children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Loader2,{className:"w-4 h-4 animate-spin mr-2"}),"Salvando treino..."]}):"Finalizar treino"})]}):(0,s.jsx)("div",{className:"p-6",children:"Rotina não encontrada."})}function u(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)("div",{className:"p-6",children:"Carregando sessão..."}),children:(0,s.jsx)(l,{})})}e.s(["default",()=>u],13097)}]);